~function(e){function i(e){return e.split(".")}var t=navigator.userAgent,o={qq:/qqbrowser/i.test(t),uc:/ucbrowser|ucweb/i.test(t),weixin:/MicroMessenger/i.test(t),baidubox:/baiduboxH5_APP/i.test(t),baidubrowser:/baidubrowser/i.test(t),baiduvideo:/videoandroid/i.test(t),miuibrowser:/miuibrowser/i.test(t),miuivideo:/miuivideo/i.test(t),oppo:/oppobrowser/i.test(t),wk:/wkbroswer/i.test(t),le:/lebrowser/i.test(t),sogou:/sogoumobilebrowser/i.test(t),sohuH5_APP:/SohuVideoMobile/i.test(t),b360:/360browser/i.test(t),hao123:/hao123/i.test(t),vivo:/vivo/i.test(t),qq_gt_5_2:!/mqqbrowser\/([0-4]|5\.[01])/.test(t),android_gt_4:/Android [^0-3]/.test(t),android_gt_5:/Android [^0-4]/.test(t),huawei_c8812:/HW-HUAWEI_C8812/i.test(t),weibo:/weibo/i.test(t),qqSns:/mobile\smqqbrowser/i.test(t),qqZone:/qzone/i.test(t),aliH5_APP:/aliH5_APP/i.test(t),ios_egt_9:/iPhone OS (\d+)/i.exec(t)&&/iPhone OS (\d+)/i.exec(t)[1]>=9,chrome_lt_35:/Chrome\/(\d{2})/i.exec(t)&&parseInt(/Chrome\/(\d{2})/i.exec(t)[1])<35,pc_chrome:/Chrome\//.test(t)&&!/Version\/4/.test(t),chrome:/Chrome/i.test(t),iqiyiH5_APP:/iqiyi/i.test(t)};o.androidChrome=$.browser.chrome&&/android/i.test(t)&&!o.qq&&!o.uc&&!o.weixin&&!o.baidubrowser&&!o.baiduvideo&&!o.miuibrowser&&!o.miuivideo&&!o.oppo&&!o.wk&&!o.le&&!o.sogou&&!o.b360&&!o.hao123&&!o.vivo,o.iosSafari=$.os.ios&&$.browser.safari&&!o.qq&&!o.baidubox&&!o.uc&&!o.weixin&&!o.baidubrowser&&!o.baiduvideo&&!o.sogou&&!o.b360,o.thirdPartSNS=o.weibo||o.qqSns||o.weixin||o.qqZone,o.androidIqiyiH5_APP=$.os.android&&o.iqiyiH5_APP,o.iosIqiyiH5_APP=$.os.ios&&o.iqiyiH5_APP,o.IqiyiVersion=function(){return t.match(/IqiyiVersion\/([0-9\.]+)/)[1]},o.IqiyiVersionCompare=function(e){var t=o.IqiyiVersion(),n=i(t),a=i(e);if(n.length!=a.length)return!1;for(var r=0,s=n.length;r<s;r++){if(parseInt(n[r])>parseInt(a[r]))return!0;if(parseInt(n[r])==parseInt(a[r])&&!a[r+1])return!0;if(parseInt(n[r])<parseInt(a[r]))return!1}return!1};var n=/iPhone OS (\d*)_(\d*)/i,a={ios:n.test(t),ios_7:n.exec(t)&&7==n.exec(t)[1],ios_8:n.exec(t)&&8==n.exec(t)[1],ios_10:n.exec(t)&&10==n.exec(t)[1],ios_9_1:n.exec(t)&&9==n.exec(t)[1]&&1==n.exec(t)[2],ios_gt_9_1:n.exec(t)&&9==n.exec(t)[1]&&n.exec(t)[2]>=1},r=/Android (\d+)\.(\d+)?\.?(\d+)?/i,s={};s.android=r.test(t),r.exec(t)&&(s.androidVersion=1e4*(r[1]||0)+100*(r[2]||0)+1*(r[3]||0)),$.extend(o,a),$.extend(o,s),$.extend($.browser,o),o.is=function(){var e=arguments[0];return e=$.isArray(e)?e:Array.prototype.slice.H5_APPly(arguments),e.some(function(e){return o[e]})},e.h5_ua=o}(window),function(){function e(){var e=H5.cookie.get("QC006");return e||(e="u"+(new Date).getTime(),H5.cookie.set("QC006",e,{expires:31536e6,path:"/",domain:"iqiyi.com"})),e}function i(){var e=H5.cookie.get("QC112");return e||(e="weid"+(new Date).getTime(),H5.cookie.set("QC112",e,{path:"/",domain:"iqiyi.com"})),e}function t(){return JSON.parse(H5.cookie.get("P00002")||"{}").uid||""}function o(e,i){var t=[];for(var o in e)t.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));var n=new Image;i=i||"//msg.iqiyi.com/jpb.gif",n.src=i+"?"+t.join("&")}window.H5=window.$||{},H5.cookie=H5.cookie||{},H5.cookie.get=function(e){var i=null,t=new RegExp("(^| )"+e+"=([^;]*)(;|$)"),o=t.exec(document.cookie);return o&&(i=o[2]||""),"string"==typeof i?i=decodeURIComponent(i):""},H5.cookie.set=function(e,i,t){t=t||{},i=encodeURIComponent(i);var o=t.expires;"number"==typeof t.expires&&(o=new Date,o.setTime(o.getTime()+t.expires)),document.cookie=e+"="+i+(t.path?"; path="+t.path:"")+(o?"; expires="+o.toGMTString():"")+(t.domain?"; domain="+t.domain:"")+(t.secure?"; secure":"")},o({rdm:(new Date).getTime(),qtcurl:location.href,rfr:document.referrer,flshuid:e(),lrfr:function(){var e=H5.cookie.get("QC007");return e||(e=document.referrer?document.referrer:"DIRECT"),e}(),ppuid:t(),platform:31,weid:i(),msrc:function(){var e=location.href.match(/msrc=([^=&#]*)/i);return e?e[1]:H5.cookie.get("QC015")}(),as:$.crypto.md5("31"+e()+i()+"ChEnYH0415dadrrEDFf2016")}),H5.sendPingback_block=function(i){var n={t:21,pf:2,p:20,p1:201,u:e(),pu:t(),jsuid:e(),rn:(new Date).getTime()};o($.extend({},n,i||{}),"//msg.iqiyi.com/b")},H5.sendPingback_click=function(i){o({t:20,pf:2,p:20,p1:201,rseat:i.rseat||"",u:e(),pu:t(),rn:(new Date).getTime()},"//msg.iqiyi.com/b")},$(document).on("click",function(i){var n=$(i.target),a=n.attr("rseat");a&&o({t:20,pf:2,p:20,p1:201,rseat:a,u:e(),pu:t(),rn:(new Date).getTime()},"//msg.iqiyi.com/b");var r=n.attr("href");r&&!/javascript\:/i.test(r)&&(i.preventDefault(),setTimeout(function(){location.href=r},500))})}(),function(e){var i={VOTE_ID:"0965795220010386",VOTE_CODE:"91ae85420c254091",GET_VOTE:"//act.vip.iqiyi.com/api/process-jsonp.action",GET_VOTE_LIST:"//vote.i.iqiyi.com/eagle/outer/get_votes",GET_USER_INFO:"//passport.iqiyi.com/apis/user/info.action?authcookie="+$.cookie.get("P00001"),GET_VOTE_CHANCE:"//act.vip.iqiyi.com/api/process-jsonp.action?interfaceCode=9c7471947a9d3922"};location.protocol.indexOf("https")>=0&&(i.GET_VOTE_LIST="//vote-i.iqiyi.com/eagle/outer/get_votes");var t=function(){return{get:function(e,i,t){return $.ajax({url:e,data:i||{},type:"GET",timeout:t||0})},post:function(e,i,t){return $.ajax({url:e,data:i||{},type:"POST",timeout:t||0})},jsonp:function(e,i,t){return $.ajax({url:e,data:i||{},dataType:"jsonp",timeout:t||0})}}}(),o={init:function(){this.hasVipInfo=!1,this.isValidVip=!1,this.isNewUser=!1,this.uid="",this.status="",this.isLoginInfo=null,this.qy_info=null},isLogin:function(){var e=$.cookie.get("P00002"),i=$.cookie.get("P00003");return this.isNotEmpty(e)&&"deleted"!==e&&this.isNotEmpty(i)&&"deleted"!==i},isNotEmpty:function(e){return""!==e&&null!==e},getStatus:function(e,i){return this.checkVipInfo("status",e,i)},checkVipInfo:function(e,i,t){var o=e?this[e]:"";return this.isLogin()&&(this.hasVipInfo?i&&i(o):this.getInfoFromInterface(i,e,t)),o},getInfoFromInterface:function(e,o,n){var a=this;if(a.isLoginInfo)e&&e(o?a[o]:"");else{if(a.isLogin()){h5_ua.ios,this.getAuthcookie(),$.cookie.get("QC006"),h5_ua.ios;return t.jsonp(i.GET_USER_INFO).then(function(i){"A00000"==i.code?(a.setVipInfo(i.data||{}),a.isLoginInfo=i.data.userinfo||{},a.qy_info=i.data.qiyi_vip_info||{},$.extend(!0,a,i.data.userinfo),e(o?a[o]:"")):n&&n()})}n&&n()}},getUserInfo:function(){var e=$.Deferred();return this.getInfoFromInterface(function(i){e.resolve(i)},"isLoginInfo",e.reject),e},setVipInfo:function(e){var i=e.pps_vip_info||{},t=e.qiyi_vip_info||{},o=parseInt(i.vip_type,10);parseFloat(t.type,10)||parseInt(t.vipType,10)&&!o?(this.vipType=String(t.vipType),this.payType=String(t.payType),this.status=String(t.status),this.level=String(t.level),this.type=String(t.type),this.hasVipInfo=!0,this.isValidVip="1"==t.status,this.vipDeadline=t.deadline):o&&(this.level=String(i.pps_level),this.vipType="1",this.payType="0",this.status="1",this.hasVipInfo=!0,this.isValidVip=!0)},getUid:function(){return this.uid},getAnonymousUid:function(){var i=$.cookie.get("QC006");return i?i:(this.isNewUser=!0,i=$.crypto.md5(e.navigator.userAgent+document.cookie+Math.random()+1*(new Date).getTime()),$.cookie.set("QC006",i,{expires:31536e6,path:"/",domain:"iqiyi.com"}),i)},checkNewUser:function(){return!$.cookie.get("QC006")||this.isNewUser},getAuthcookie:function(){return $.cookie.get("P00001")||""},goToLogin:function(){h5_ua.iqiyiapp?iqiyi.ready(function(e){e&&iqiyi.loadNativePage({page:"login",returnUrl:location.href,param:{}})}):e.location.href="//m.iqiyi.com/user.html?redirectUrl="+encodeURIComponent(location.href)},logout:function(){var i=encodeURIComponent(e.location.href);e.location.href="//passport.iqiyi.com/user/logout.php?url="+i+"&logoutcb=Q.__logoutcb"}};({cardPageUrl:"//vip.iqiyi.com/idol-gift-list.html",pageUrl:"http://vip.iqiyi.com/idol-gift-vote.html",buyCardPageUrl:"//vip.iqiyi.com/ouxiangBuy.html",shareData:{title:"买偶像练习生定制会员卡，一起为pick的练习生投票！",desc:"爱奇艺偶像练习生定制VIP卡，购卡并转赠后可获得专属投票次数，每张最多30票",shareType:1,imgUrl:"http://pic1.qiyipic.com/ext/common/share.jpeg",link:"http://vip.iqiyi.com/idol-gift-vote.html"},velocityTpl:null,voteChance:0,voteAction:!1,voteAgain:!0,appInfo:{},init:function(){var e=this;setTimeout(function(){iqiyi.ready(function(i){iqiyi.onShare(e.shareData),iqiyi.hideMenu()}),wx&&h5_ua.weixin&&(wx.onMenuShareAppMessage(e.shareData),wx.onMenuShareTimeline(e.shareData),wx.onMenuShareQQ(e.shareData))},1e3),o.init(),o.getUserInfo().then(function(e){e?$(".logoutarea").removeClass("dn").find(".m-persname").text("您好，"+e.nickname):$(".loginarea").removeClass("dn")},function(e){$(".loginarea").removeClass("dn")}),o.isLogin()?($("logoutarea").removeClass("dn"),h5_ua.iqiyiH5_APP&&$(".logoutarea .m-hidein").addClass("dn"),t.jsonp(i.GET_VOTE_CHANCE,{P00001:o.getAuthcookie()}).then(function(i){if("string"==typeof i&&(i=JSON.parse(i)),i=i.data,"A00000"==i.code){var t=parseInt(i.data.daysurpluschance);$(".m-havevote .c-num").text(t),e.voteChance=t,e.voteAction=!0}else console.log("get vote chance fail")},function(){console.log("get vote change fail")}).always(function(){e.voteAction=!0}),h5_ua.iqiyiH5_APP?iqiyi.init(function(i){1==parseInt(i.result)&&(e.appInfo=i.data)}):dfp.getFingerPrint(function(i){e.appInfo.dfp=i})):($(".loginarea").removeClass("dn"),e.voteAction=!0),e.getVoteList(),this.bindEvent()},share:function(e,i){this.shareData.title=e,this.shareData.link=i,iqiyi&&h5_ua.iqiyiH5_APP?iqiyi.share(this.shareData):wx&&h5_ua.weixin&&(wx.onMenuShareAppMessage(this.shareData),wx.onMenuShareTimeline(this.shareData),wx.onMenuShareQQ(this.shareData))},bindEvent:function(){var n=this;$(".m-votewra .m-rulepop").on("click",function(e){$("#dialog-vote-guide").removeClass("dn"),$("#dialog-vote-guide .m-suretext").one("click",function(e){$("#dialog-vote-guide").addClass("dn")})}),$(".loginout").on("touchend",function(e){e.preventDefault(),o.logout()}),$(".loginbtn").on("touchend",function(e){e.preventDefault(),o.goToLogin()}),$(".c-piao").on("click",function(i){e.location.href=n.cardPageUrl}),$(".m-gocardba").on("click",function(i){e.location.href=n.buyCardPageUrl}),$(".m-linknew").on("click",function(e){e.preventDefault(),location.reload()}),$(".m-voteperlist").on("click",".c-piao",function(e){e.preventDefault();var a=$(this),r=$(this).data("oid"),s=$(this).hasClass("disable");if(n.voteAction&&!s){if(!o.isLogin())return void n.showDialogLogin();if(!n.voteChance)return console.log("vote chance over"),void n.showDialog();if(!a.hasClass("requesting")&&$("#pop-voting").hasClass("dn")&&n.voteAgain){$("#pop-voting").removeClass("dn"),n.voteAgain=!1,a.addClass("requesting");var c={interfaceCode:i.VOTE_CODE,cvid:n.voteInfo.vcId,P00001:o.getAuthcookie(),oid:r,dfp:n.appInfo.dfp||"",version:n.appInfo.version||"",device_id:n.appInfo.deviceId||""};t.jsonp(i.GET_VOTE,c).then(function(e){"string"==typeof e&&(e=JSON.parse(e)),e=e.data;var i=e.code,t=(e.msg,e.data.daysurpluschance);"A00000"==i?(n.voteChance--,$(".m-havevote .c-num").text(t),n.toast("投票成功")):"Q00304"==i?o.goToLogin():"Q00382"==i?n.showDialog():"Q00300"==i?n.toast("您操作太快了，请休息一会儿！"):n.toast()},function(){n.toast()}).always(function(){a.removeClass("requesting"),$("#pop-voting").addClass("dn"),n.frequenceControl()})}}})},getVoteList:function(){var e=this;e.velocity||(e.velocity=new $.plugins.Velocity($("#voteList").html())),t.jsonp(i.GET_VOTE_LIST,{vids:i.VOTE_ID}).then(function(i){if("string"==typeof i&&(i=JSON.parse(i)),"A00000"==i.code&&i.data[0]){e.voteInfo=i.data[0],e.voteInfo.vcId=e.voteInfo.childs[0].vcId;var t=i.data[0]&&i.data[0].childs&&i.data[0].childs[0].options||[],o={status:e.voteInfo.status,list:t};e.render(e.format(o))}else e.toast("哇哦，遇到一点问题，再试一下吧"),$(".m-listerror").removeClass("dn")},function(){e.toast("哇哦，遇到一点问题，再试一下吧"),$(".m-listerror").removeClass("dn")}).always(function(){$("#pop-loading").addClass("dn")})},format:function(e){return e.list.forEach(function(i,t){e.list.length;if(!i.picUrl)return e.list.splice(t,1),void e.list.length--;i.kv=JSON.parse(i.kv),i.kvStatus=i.kv.status,i.order=i.kv.order,i.status=e.status}),e.list},render:function(e){var i=this,t=i.velocity.render({list:e});$(".m-voteperlist").html(t)},toast:function(e,i){var i=i||1e3,e=e||"投票失败了！请稍后重试";$("#pop-toast").removeClass("dn").find("p").text(e),setTimeout(function(){$("#pop-toast").addClass("dn")},i)},showDialog:function(){var i=this;$("#dialog-vote-over").removeClass("dn"),$("#dialog-vote-over .cancelbtn").one("click",function(e){$("#dialog-vote-over").addClass("dn")}),$("#dialog-vote-over .gotocard").off(),$("#dialog-vote-over .gotocard").on("click",function(t){e.location.href=i.buyCardPageUrl})},showDialogLogin:function(){$("#dialog-vote-login").removeClass("dn"),$("#dialog-vote-login .cancelbtn").one("click",function(e){$("#dialog-vote-login").addClass("dn")}),$("#dialog-vote-login .confirmbtn").one("click",function(e){o.goToLogin()})},frequenceControl:function(){var e=this;setTimeout(function(){e.voteAgain=!0},1500)}}).init()}(window);