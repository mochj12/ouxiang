~function(e){function i(e){return e.split(".")}var t=navigator.userAgent,o={qq:/qqbrowser/i.test(t),uc:/ucbrowser|ucweb/i.test(t),weixin:/MicroMessenger/i.test(t),baidubox:/baiduboxH5_APP/i.test(t),baidubrowser:/baidubrowser/i.test(t),baiduvideo:/videoandroid/i.test(t),miuibrowser:/miuibrowser/i.test(t),miuivideo:/miuivideo/i.test(t),oppo:/oppobrowser/i.test(t),wk:/wkbroswer/i.test(t),le:/lebrowser/i.test(t),sogou:/sogoumobilebrowser/i.test(t),sohuH5_APP:/SohuVideoMobile/i.test(t),b360:/360browser/i.test(t),hao123:/hao123/i.test(t),vivo:/vivo/i.test(t),qq_gt_5_2:!/mqqbrowser\/([0-4]|5\.[01])/.test(t),android_gt_4:/Android [^0-3]/.test(t),android_gt_5:/Android [^0-4]/.test(t),huawei_c8812:/HW-HUAWEI_C8812/i.test(t),weibo:/weibo/i.test(t),qqSns:/mobile\smqqbrowser/i.test(t),qqZone:/qzone/i.test(t),aliH5_APP:/aliH5_APP/i.test(t),ios_egt_9:/iPhone OS (\d+)/i.exec(t)&&/iPhone OS (\d+)/i.exec(t)[1]>=9,chrome_lt_35:/Chrome\/(\d{2})/i.exec(t)&&parseInt(/Chrome\/(\d{2})/i.exec(t)[1])<35,pc_chrome:/Chrome\//.test(t)&&!/Version\/4/.test(t),chrome:/Chrome/i.test(t),iqiyiH5_APP:/iqiyi/i.test(t)};o.androidChrome=$.browser.chrome&&/android/i.test(t)&&!o.qq&&!o.uc&&!o.weixin&&!o.baidubrowser&&!o.baiduvideo&&!o.miuibrowser&&!o.miuivideo&&!o.oppo&&!o.wk&&!o.le&&!o.sogou&&!o.b360&&!o.hao123&&!o.vivo,o.iosSafari=$.os.ios&&$.browser.safari&&!o.qq&&!o.baidubox&&!o.uc&&!o.weixin&&!o.baidubrowser&&!o.baiduvideo&&!o.sogou&&!o.b360,o.thirdPartSNS=o.weibo||o.qqSns||o.weixin||o.qqZone,o.androidIqiyiH5_APP=$.os.android&&o.iqiyiH5_APP,o.iosIqiyiH5_APP=$.os.ios&&o.iqiyiH5_APP,o.IqiyiVersion=function(){return t.match(/IqiyiVersion\/([0-9\.]+)/)[1]},o.IqiyiVersionCompare=function(e){var t=o.IqiyiVersion(),n=i(t),a=i(e);if(n.length!=a.length)return!1;for(var r=0,s=n.length;r<s;r++){if(parseInt(n[r])>parseInt(a[r]))return!0;if(parseInt(n[r])==parseInt(a[r])&&!a[r+1])return!0;if(parseInt(n[r])<parseInt(a[r]))return!1}return!1};var n=/iPhone OS (\d*)_(\d*)/i,a={ios:n.test(t),ios_7:n.exec(t)&&7==n.exec(t)[1],ios_8:n.exec(t)&&8==n.exec(t)[1],ios_10:n.exec(t)&&10==n.exec(t)[1],ios_9_1:n.exec(t)&&9==n.exec(t)[1]&&1==n.exec(t)[2],ios_gt_9_1:n.exec(t)&&9==n.exec(t)[1]&&n.exec(t)[2]>=1},r=/Android (\d+)\.(\d+)?\.?(\d+)?/i,s={};s.android=r.test(t),r.exec(t)&&(s.androidVersion=1e4*(r[1]||0)+100*(r[2]||0)+1*(r[3]||0)),$.extend(o,a),$.extend(o,s),$.extend($.browser,o),o.is=function(){var e=arguments[0];return e=$.isArray(e)?e:Array.prototype.slice.H5_APPly(arguments),e.some(function(e){return o[e]})},e.h5_ua=o}(window),function(){function e(){var e=H5.cookie.get("QC006");return e||(e="u"+(new Date).getTime(),H5.cookie.set("QC006",e,{expires:31536e6,path:"/",domain:"iqiyi.com"})),e}function i(){var e=H5.cookie.get("QC112");return e||(e="weid"+(new Date).getTime(),H5.cookie.set("QC112",e,{path:"/",domain:"iqiyi.com"})),e}function t(){return JSON.parse(H5.cookie.get("P00002")||"{}").uid||""}function o(e,i){var t=[];for(var o in e)t.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));var n=new Image;i=i||"//msg.iqiyi.com/jpb.gif",n.src=i+"?"+t.join("&")}window.H5=window.$||{},H5.cookie=H5.cookie||{},H5.cookie.get=function(e){var i=null,t=new RegExp("(^| )"+e+"=([^;]*)(;|$)"),o=t.exec(document.cookie);return o&&(i=o[2]||""),"string"==typeof i?i=decodeURIComponent(i):""},H5.cookie.set=function(e,i,t){t=t||{},i=encodeURIComponent(i);var o=t.expires;"number"==typeof t.expires&&(o=new Date,o.setTime(o.getTime()+t.expires)),document.cookie=e+"="+i+(t.path?"; path="+t.path:"")+(o?"; expires="+o.toGMTString():"")+(t.domain?"; domain="+t.domain:"")+(t.secure?"; secure":"")},o({rdm:(new Date).getTime(),qtcurl:location.href,rfr:document.referrer,flshuid:e(),lrfr:function(){var e=H5.cookie.get("QC007");return e||(e=document.referrer?document.referrer:"DIRECT"),e}(),ppuid:t(),platform:31,weid:i(),msrc:function(){var e=location.href.match(/msrc=([^=&#]*)/i);return e?e[1]:H5.cookie.get("QC015")}(),as:$.crypto.md5("31"+e()+i()+"ChEnYH0415dadrrEDFf2016")}),H5.sendPingback_block=function(i){var n={t:21,pf:2,p:20,p1:201,u:e(),pu:t(),jsuid:e(),rn:(new Date).getTime()};o($.extend({},n,i||{}),"//msg.iqiyi.com/b")},H5.sendPingback_click=function(i){o({t:20,pf:2,p:20,p1:201,rseat:i.rseat||"",u:e(),pu:t(),rn:(new Date).getTime()},"//msg.iqiyi.com/b")},$(document).on("click",function(i){var n=$(i.target),a=n.attr("rseat");a&&o({t:20,pf:2,p:20,p1:201,rseat:a,u:e(),pu:t(),rn:(new Date).getTime()},"//msg.iqiyi.com/b");var r=n.attr("href");r&&!/javascript\:/i.test(r)&&(i.preventDefault(),setTimeout(function(){location.href=r},500))})}(),function(e){var i={GET_GIFT_LIST:"//act.vip.iqiyi.com/marketing/query/gift-card/list.action",GET_VOTE_CHANCE:"//act.vip.iqiyi.com/api/process.action?interfaceCode=9c7471947a9d3922",GET_USER_INFO:"//passport.iqiyi.com/apis/user/info.action?authcookie="+$.cookie.get("P00001"),GET_GIFT_CARD:"//act.vip.iqiyi.com/marketing/gift-card/get.action"},t=function(){return{get:function(e,i,t){return $.ajax({url:e,data:i||{},type:"GET",timeout:t||0})},post:function(e,i,t){return $.ajax({url:e,data:i||{},type:"POST",timeout:t||0})},jsonp:function(e,i,t){return $.ajax({url:e,data:i||{},dataType:"jsonp",timeout:t||0})}}}(),o={init:function(){this.hasVipInfo=!1,this.isValidVip=!1,this.isNewUser=!1,this.uid="",this.status="",this.isLoginInfo=null,this.qy_info=null},isLogin:function(){var e=$.cookie.get("P00002"),i=$.cookie.get("P00003");return this.isNotEmpty(e)&&"deleted"!==e&&this.isNotEmpty(i)&&"deleted"!==i},isNotEmpty:function(e){return""!==e&&null!==e},getStatus:function(e,i){return this.checkVipInfo("status",e,i)},checkVipInfo:function(e,i,t){var o=e?this[e]:"";return this.isLogin()&&(this.hasVipInfo?i&&i(o):this.getInfoFromInterface(i,e,t)),o},getInfoFromInterface:function(e,o,n){var a=this;if(a.isLoginInfo)e&&e(o?a[o]:"");else{if(a.isLogin()){h5_ua.ios,this.getAuthcookie(),$.cookie.get("QC006"),h5_ua.ios;return t.jsonp(i.GET_USER_INFO).then(function(i){"A00000"==i.code?(a.setVipInfo(i.data||{}),a.isLoginInfo=i.data.userinfo||{},a.qy_info=i.data.qiyi_vip_info||{},e(o?a[o]:"")):n&&n()})}n&&n()}},getUserInfo:function(){var e=$.Deferred();return this.getInfoFromInterface(function(i){e.resolve(i)},"isLoginInfo",e.reject),e},setVipInfo:function(e){var i=e.pps_vip_info||{},t=e.qiyi_vip_info||{},o=parseInt(i.vip_type,10);parseFloat(t.type,10)||parseInt(t.vipType,10)&&!o?(this.vipType=String(t.vipType),this.payType=String(t.payType),this.status=String(t.status),this.level=String(t.level),this.type=String(t.type),this.hasVipInfo=!0,this.isValidVip="1"==t.status,this.vipDeadline=t.deadline):o&&(this.level=String(i.pps_level),this.vipType="1",this.payType="0",this.status="1",this.hasVipInfo=!0,this.isValidVip=!0)},getUid:function(){return this.uid},getAnonymousUid:function(){var i=$.cookie.get("QC006");return i?i:(this.isNewUser=!0,i=$.crypto.md5(e.navigator.userAgent+document.cookie+Math.random()+1*(new Date).getTime()),$.cookie.set("QC006",i,{expires:31536e6,path:"/",domain:"iqiyi.com"}),i)},checkNewUser:function(){return!$.cookie.get("QC006")||this.isNewUser},getAuthcookie:function(){return $.cookie.get("P00001")||""},goToLogin:function(){h5_ua.iqiyiapp?iqiyi.ready(function(e){e&&iqiyi.loadNativePage({page:"login",returnUrl:location.href,param:{}})}):e.location.href="//m.iqiyi.com/user.html?redirectUrl="+encodeURIComponent(location.href)}},n=!0;$(document.body).on("touchmove",function(e){n||e.preventDefault()}),{pageUrl:"http://new.cms.iqiyi.com/page!preview.action?pageId=8836303",votePageUrl:"http://new.cms.iqiyi.com/page!preview.action?pageId=8842712",buyCardPageUrl:"http://new.cms.iqiyi.com/page!preview.action?pageId=8853328",shareCardPageUrl:"http://new.cms.iqiyi.com/page!preview.action?pageId=8843693",shareData:{title:"买偶像练习生定制会员卡，一起为pick的练习生投票！",desc:"爱奇艺偶像练习生定制VIP卡，购卡并转赠后可获得专属投票次数，每张最多30票",shareType:1,imgUrl:"http://pic1.qiyipic.com/ext/common/share.jpeg",link:location.href||""},velocityTpl:null,curCardInfo:{},init:function(){var e=this;if(setTimeout(function(){iqiyi.ready(function(i){iqiyi.onShare(e.shareData),iqiyi.hideMenu()}),wx&&h5_ua.weixin&&(wx.onMenuShareAppMessage(e.shareData),wx.onMenuShareTimeline(e.shareData),wx.onMenuShareQQ(e.shareData))},1e3),o.init(),o.getUserInfo().then(function(e){},function(e){}),!o.isLogin())return void o.goToLogin();t.get(i.GET_VOTE_CHANCE,{P00001:o.getAuthcookie()}).then(function(e){if("string"==typeof e&&(e=JSON.parse(e)),console.log(e),"A00000"==e.code){var i=e.data.daysurpluschance||0;$(".m-degree").find(".m-num").text(i)}}),e.getGiftList(),this.bindEvent()},share:function(e,i){var t=this;this.shareData.title=e,this.shareData.link=i,iqiyi&&h5_ua.iqiyiH5_APP?iqiyi.ready(function(){iqiyi.share(t.shareData)}):wx&&h5_ua.weixin&&(wx.onMenuShareAppMessage(this.shareData),wx.onMenuShareTimeline(this.shareData),wx.onMenuShareQQ(this.shareData))},bindEvent:function(){var i=this;$(".specialGuide").on("click",function(e){$(".cover").removeClass("dn"),$("#dialog-rigths").removeClass("dn"),$("#dialog-rigths .m-suretext").one("click",function(e){$(".cover").addClass("dn"),$("#dialog-rigths").addClass("dn")})}),$(".c-piao").on("click",function(t){e.location.href=i.votePageUrl}),$(".m-truecontent, .m-empty .m-gocard").on("click",function(t){$(this).hasClass("refreshbtn")||(e.location.href=i.buyCardPageUrl)}),$(".m-cardlist").on("click",".m-receive-gift",function(e){e.preventDefault();var t=$(this),o=$(this).data("giftcardno");i.showConfirmGet(t,o)}),$(".m-cardlist").on("click",".m-fri",function(e){var t=$(this).data("giftcardno"),o=$(this).data("remain"),n=$(this).data("cardtitle");i.showShareConfirm(t,o,n)})},getGiftList:function(){var e=this;e.velocity||(e.velocity=new $.plugins.Velocity($("#cardList").html())),t.get(i.GET_GIFT_LIST,{P00001:o.getAuthcookie(),actCode:"b0b82d8c897acd79"}).then(function(i){"string"==typeof i&&(i=JSON.parse(i)),console.log(i);var t=i.code;if("A00000"==t){var n=i.data.list||[];n.length?($(".m-havecard").removeClass("dn"),$(".m-gocustom").removeClass("dn"),e.render(e.format(n))):($(".m-havecard").addClass("dn"),$(".m-empty").removeClass("dn"),$(".m-gocustom").addClass("dn"))}else"Q00304"==t?o.goToLogin():(e.toast("哇哦，遇到一点问题，再试一下吧"),$(".m-havecard").addClass("dn"),$(".m-empty").removeClass("dn"),$(".m-gocustom").addClass("dn"))},function(){e.toast("哇哦，遇到一点问题，再试一下吧"),$(".m-havecard").addClass("dn"),$(".m-empty").removeClass("dn").find(".m-note").text("加载失败"),$(".m-empty .m-gocard").addClass("dn"),$(".m-empty .refreshbtn").removeClass("dn"),$(".m-gocustom").addClass("dn")}).always(function(){$("#pop-loading").addClass("dn")})},format:function(e){return e.forEach(function(e,i){e.remain=e.total-e.receive,e.orderPrice/=100}),e},render:function(e){var i=this,t=i.velocity.render({list:e});$(".m-cardlist").html(t)},showConfirmGet:function(e,n){var a=this;$(".cover").removeClass("dn"),$("#dialog-get").removeClass("dn"),$("#dialog-get .cancelbtn").one("click",function(e){$(".cover").addClass("dn"),$("#dialog-get").addClass("dn")}),$("#dialog-get .confirmbtn").off(),$("#dialog-get .confirmbtn").on("click",function(r){var s=$(this);s.hasClass("requesting")||($("#dialog-get").addClass("dn"),s.addClass("requesting"),t.get(i.GET_GIFT_CARD,{P00001:o.getAuthcookie(),giftCardNo:n}).then(function(i){"string"==typeof i&&(i=JSON.parse(i));var t=i.code;i.msg;if(console.log(i),"A00000"==t){var o=i.data.hasLeft;e.data("remain",o).next().data("remain",o),o||e.parent().hide().next().removeClass("dn"),e.parents(".m-textdetail").find(".c-gerting").text(o+"张待领取"),a.getResult(1)}else"Q00376"==t?a.getResult(3):"A00002"==t?a.getResult(2):a.getResult(0)},function(){a.getResult(0,"领取失败，请您稍后重试")}).always(function(){s.removeClass("requesting")}))})},showShareConfirm:function(e,i,t){var o=this;t||(t="爱奇艺VIP月卡");var a="";a+=o.shareCardPageUrl.indexOf("?")==-1?"?":"&";var r=o.shareCardPageUrl+a+"giftCardNo="+e,s="送你一张"+t+"，一起为pick的练习生投票！";h5_ua.iqiyiH5_APP?($(".cover").removeClass("dn"),$("#dialog-share .c-violet").text(i),$("#dialog-share").removeClass("dn"),$("#dialog-share .cancelbtn").one("click",function(e){$(".cover").addClass("dn"),$("#dialog-share").addClass("dn")}),$("#dialog-share .confirmbtn").off(),$("#dialog-share .confirmbtn").one("click",function(e){$(".cover").addClass("dn"),$("#dialog-share").addClass("dn"),o.share(s,r)})):h5_ua.weixin||h5_ua.qq?(n=!1,$("#pop_weixin").removeClass("dn"),$("#pop_weixin .m-sclose").one("touchend",function(e){e.preventDefault(),$("#pop_weixin").addClass("dn"),n=!0})):($(".cover").removeClass("dn"),$("#pop_browser").removeClass("dn"),$("#pop_browser .m-suretext").one("click",function(e){e.preventDefault(),$(".cover").addClass("dn"),$("#pop_browser").addClass("dn")}))},getResult:function(e,i){var t=this;console.log(e,i),1==e?($(".cover").removeClass("dn"),$("#dialog-get-result").removeClass("dn"),$("#dialog-get-result .m-suretext").one("click",function(e){$(".cover").addClass("dn"),$("#dialog-get-result").addClass("dn")})):2==e?($(".cover").removeClass("dn"),$("#dialog-get-result-over").removeClass("dn"),$("#dialog-get-result-over .m-suretext").one("click",function(e){$(".cover").addClass("dn"),$("#dialog-get-result-over").addClass("dn")})):3==e?($(".cover").removeClass("dn"),$("#dialog-get-result-late").removeClass("dn"),$("#dialog-get-result-late .m-suretext").one("click",function(e){$(".cover").addClass("dn"),$("#dialog-get-result-late").addClass("dn")})):($(".cover").addClass("dn"),$("#dialog-get-result").addClass("dn"),t.toast(i))},toast:function(e,i){var i=i||3e3,e=e||"领取失败，请您稍后重试";$("#dialog-toast p").text(e),$("#dialog-toast").removeClass("dn"),setTimeout(function(){$("#dialog-toast").addClass("dn")},i)}}.init()}(window);